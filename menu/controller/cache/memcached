#!/bin/bash

# shellcheck disable=SC1091
source /var/hostvn/script/menu/helpers/function
# shellcheck disable=SC1091
source /var/hostvn/script/menu/helpers/menu

CHOICE=1

echo "-------------------------------------------------------------------------"
echo "Quản lý Memcached"
echo "-------------------------------------------------------------------------"
status=$(systemctl status memcached.service | grep 'Active' | cut -f2 -d':' | xargs | cut -f1 -d' ' | xargs)
echo "Trạng thái: ${status}"
echo "-------------------------------------------------------------------------"

while [ "${CHOICE}" != "0" ]
do
    echo "1. Mở Memcached"
    echo "2. Tắt Memcached"
    echo " ----------------------------------------------- "
    read -p " Nhập vào lựa chọn của bạn [0 = Thoát] " CHOICE

    if [ -z "${CHOICE}" ]
    then
        CHOICE=1
        continue
    fi
    case ${CHOICE} in
        1)
            echo "Đang tiến hành mở Memcached..."
            sleep 1
            systemctl start memcached
            systemctl enable memcached
            clear
            echo "Đã bật Memcached"
            echo
            menu_cache
            ;;
        2)
            echo "Đang tiến hành tắt Memcached..."
            sleep 1
            systemctl stop memcached
            systemctl disable memcached
            clear
            echo "Đã tắt Memcached"
            echo
            menu_cache
            ;;
        0) menu_primary ;;
        *) echo -e "Lựa chọn của bạn không chính xác. Vui lòng chọn lại.";;
    esac
done